- first analyze the y one by one

go to the yN folder, prepare the zconfig.cfg files in such a way that the right mppc numbers are selected etc. See example of relevant lines here:

# doi tagging bench
usingTaggingBench = 1      # if this is a tagging DOI bench measurement, put 1, otherwise 0
taggingPosition = 13.6     # position of the tagging bench in mm 
taggingCrystalChannel = 16  
digiChannelsForDoi = 12,13,14,15
doiColumnOffset = 1        # for DOI output, fix the column i by adding this quantity. if not stated, 0 by default

IMPORTANT - doiColumnOffset has to be chosen between 0 and 1 (or more) according the the real column under investigation in this y. otherwise it's always interpreted as 0 (i.e. the leftmost column of crystals in this mppc)

Then from the yN folder start the dataset analysis

for j in z0 z1 z2 z3 z4; do cd $j/Run*/; ModuleCalibration -c zconfig.cfg `ls TTree_*` ; cd ../../; done

afterwards, move the doiData files

for i in y0 y1 y2 y3 y4 y5 y6 y7 ; do for j in z0 z1 z2 z3 z4; do cp $i/$j/Run*/doiData.txt $i/$j/doiData.txt ; done; done

and do the doi analysis for each yN with

doifit

from the yN folder. This produces a calibration_params.txt and a doi.txt file for each yN folder, then copy them in the "all" folder: from the DOI_scan folder do 

for i in y0 y1 y2 y3 y4 y5 y6 y7 ; do cp $i/calibration_params.txt ./all/${i}calibration_params.txt ; cp $i/doi.txt ./all/${i}doi.txt; done

and cat them to single files: from the all folder do

for i in y0 y1 y2 y3 y4 y5 y6 y7 ; do  cat ${i}calibration_params.txt >> calibration_params.txt; done
for i in y0 y1 y2 y3 y4 y5 y6 y7 ; do  cat ${i}doi.txt >> doi.txt; done


THE SCRIPT startAnalysis.sh will do all this for you.
